 
"""decision tree.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Nx-mlp9vw53xyh7XnvGgTdjhwH92d0po
"""

 

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier, _tree
from sklearn.metrics import accuracy_score, classification_report
 
df = pd.read_csv("D:\DataMining\projectphase2\Loan-prediction\Project\Cleaned_Loan_Train_Data.csv")

 
df.head()

df.columns

 

TARGET_COL = "Loan_Status"

X = df.drop(columns=[TARGET_COL])
y = df[TARGET_COL]

print("Feature columns:", list(X.columns))
print("Target sample values:", y.unique())

 

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.2,      
    random_state=42,    
    stratify=y           
)

dt = DecisionTreeClassifier(
    criterion="entropy",
    max_depth=5,          
    min_samples_split=10,  
    min_samples_leaf=5,   
    random_state=42
)


dt.fit(X_train, y_train)



y_pred = dt.predict(X_test)

print("Accuracy on test set:", accuracy_score(y_test, y_pred))
print("\nClassification Report:\n")
print(classification_report(y_test, y_pred))

 

def print_yes_no_tree(clf, feature_names, target_names=None, indent="  "):
    """
    Prints a decision tree as nested Yes/No questions.

    clf : trained DecisionTreeClassifier
    feature_names : list of feature names (X.columns)
    target_names : optional list of class names, e.g. ["Not Approved", "Approved"]
    indent : indentation string for each depth level
    """
    tree_ = clf.tree_
    feature_name = [
        feature_names[i] if i != _tree.TREE_UNDEFINED else "undefined!"
        for i in tree_.feature
    ]

     
    if target_names is None:
        target_names = [str(c) for c in clf.classes_]

    def recurse(node, depth):
        prefix = indent * depth

         
        if tree_.feature[node] == _tree.TREE_UNDEFINED:
            class_idx = tree_.value[node].argmax()
            class_name = target_names[class_idx]
            print(f"{prefix}=> Predict: {class_name} "
                  f"(samples = {tree_.n_node_samples[node]})")
        else:
            name = feature_name[node]
            threshold = tree_.threshold[node]

             
            print(f"{prefix}Is {name} <= {threshold:.3f}?")

             
            print(f"{prefix}├─ Yes:")
            recurse(tree_.children_left[node], depth + 1)

             
            print(f"{prefix}└─ No:")
            recurse(tree_.children_right[node], depth + 1)

    
    recurse(0, 0)

 

feature_names = list(X.columns)

 
target_names = ["Not Approved", "Approved"]

print_yes_no_tree(dt, feature_names=feature_names, target_names=target_names)

from sklearn import tree
import matplotlib.pyplot as plt

plt.figure(figsize=(25, 10))
tree.plot_tree(
    dt,
    filled=True,
    rounded=True,
    feature_names=X.columns,
    class_names=["Not Approved", "Approved"]
)
plt.show()